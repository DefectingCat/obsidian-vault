## 界面

### 基础设置

![[Pasted image 20230130142143.png]]

原有展台设置可以迁移到【基础】设置中，当前工程在【上架/公开】后即为直接访问的展台。原有的针对展台的设置以及一些全局设置都可以放在【基础】设置中。

![[Pasted image 20230130142513.png]]

### 功能模块

对于展台的功能设置，可以考虑按功能拆分模块按钮。在进入到对应的功能设置后，在右侧再显示该功能的详细设置。

![[Pasted image 20230130143427.png]]

![[Pasted image 20230130143608.png]]

### 界面布局

界面布局比较重要的一个部分就是设置的层级深度。层级越深，找到一个设置就越麻烦。

![[Pasted image 20230130151120.png]]

以前对于展台的设置，需要至少三个层级才能进行设置。对于一些常用的设置可以考虑放在一级菜单页面上。

![[Pasted image 20230130151343.png]]

## 性能优化

对于性能方面，同一个场景内随着功能的添加可能会越来越复杂。在编辑器中，可以考虑针对当前设置功能的渲染/预览。

例如当前场景的热点添加的比较多时，此时再切换到【视角】功能区设置视角可以不渲染热点。当用户需要预览整个工程时，再通过专门的预览模块去预览整个效果。

> 对于嵌入到场景/模型中的内容可以考虑一直都显示。目前热点图标的渲染方式是利用 DOM 在浏览器中渲染，旋转视角时是直接操作所有热点 DOM 改变位置，而浏览器 DOM 非常的笨重，这是导致性能降低的一个很重要的因素。

![[Pasted image 20230130144205.png]]

![[Pasted image 20230130144300.png]]

### 不同设置的懒加载

当功能按模块区分后，不同设置可以做成页面路由而非组件。这样就可以再配合路由的懒加载与代码分割。

例如使用路由后，从【视角】设置 `edit/view` 切换到【热点】设置 `edit/hotspot` 为路由的切换，子路由只展示模型 `Canvas`，这样也能更好的配合显示不同的设置功能。

## 其他方面

### 解耦合

页面（编辑器、工程展示等）与 three.js 的渲染引擎（Show Library 项目）的解耦合。

对于当前的前端页面需要由状态驱动，一个工程的全局状态可能如下。

```js
{
	view: { ... },
	spots: { ... },
	embeds: { ... },
}
```

但全局状态只是为了驱动当前的页面渲染，对于我们的 three.js 渲染组件，完全不需要知道全局状态的存在，可以完全解耦合。当设置对应功能时可以通过事件或暴漏出对应的设置方法等：

```js
GlobalEvent.dispatch('change_view', payloadView);
```

### 是否需要全局状态

同理，哪些状态应该放在全局状态。对于现在的页面来说，全局状态有两个作用：渲染页面和保存所有设置到一个位置，更方便的发送到后端保存。

对于第一个作用，一些不跨越其他组件/页面的设置可以考虑不放在全局状态。例如视角设置，视角设置对其他设置没有交集，该状态可以由视角设置自己维护。对于第一次进入该组件时，默认/当前的状态应该从引擎中获取。这样也能避免修改了状态，而引擎那边却没有修改的问题。